{
  "process_graph": {
    "loadcollection1": {
      "process_id": "load_collection",
      "arguments": {
        "bands": [
          "B04",
          "B03",
          "B02"
        ],
        "id": "SENTINEL2_L2A",
        "properties": {
          "eo:cloud_cover": {
            "process_graph": {
              "lte1": {
                "process_id": "lte",
                "arguments": {
                  "x": {
                    "from_parameter": "value"
                  },
                  "y": 70
                },
                "result": true
              }
            }
          }
        },
        "spatial_extent": null,
        "temporal_extent": {
          "from_parameter": "temporal_extent"
        }
      }
    },
    "loadurl1": {
      "process_id": "load_url",
      "arguments": {
        "format": "Parquet",
        "url": "https://s3.prod.warsaw.openeo.dataspace.copernicus.eu/OpenEO-artifacts/7b9a7a133160c440a4fa6586e3a3de183e1df18e/2024/11/18/bounding_box_geometry.parquet?AWSAccessKeyId=93bf46120a0b46e18320c7a794f7c5d0&Signature=RtwpmS%2B%2B3gA9t01PTyDQ5dHGw%2BM%3D&x-amz-security-token=eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2xlX2FybiI6ImFybjphd3M6aWFtOjowMDAwMDAwMDAwMDA6cm9sZS9TM0FjY2VzcyIsImluaXRpYWxfaXNzdWVyIjoiaHR0cHM6Ly9pZGVudGl0eS5kYXRhc3BhY2UuY29wZXJuaWN1cy5ldS9hdXRoL3JlYWxtcy9DRFNFIiwiaXNzIjoic3RzLnByb2Qud2Fyc2F3Lm9wZW5lby5kYXRhc3BhY2UuY29wZXJuaWN1cy5ldSIsInN1YiI6ImE0MjFmODQ5LTJhZTYtNDJkMy05M2YwLWI0M2FhMjU2N2YxZSIsImV4cCI6MTczMTk2OTQ4OCwibmJmIjoxNzMxOTI2Mjg4LCJpYXQiOjE3MzE5MjYyODgsImp0aSI6ImI0MTAzNzZhLWIyNzItNDAxNC1hMzUyLTgzOTZhMWM2NjczMSJ9.nETcVLb8OHY6AiODQT6wxKWLMlgsP7CMnhyYfFWy9Z8SAs3hQiCunEXwogX8etLa6SMUIDKY5dsit6f8R2sNS-BInrz2H8phqc7gYC6MXAhsxis8QPDS9I5mvuD4m0DOnUZJ2Sd36TmQ7gNbdF2aLRZeH-ikCgNaE990JHmywhkR1z5r1nR5HCRKS2V8evy6n9jj9_5bmt-qrjx27I2o0xhGAY0E9tg49UEA7Cerjh5zdJ-SLtudPUPp8_gGPSC5CfVlLfBdBJWBQiDwq6qaf884yhdJ-ObnNHS73japZEPmd7rjOfOsBlkA6Jk8OqlesjKzpCD-Bm454IdkGf4p_w&Expires=1732444689"
      }
    },
    "filterspatial1": {
      "process_id": "filter_spatial",
      "arguments": {
        "data": {
          "from_node": "loadcollection1"
        },
        "geometries": {
          "from_node": "loadurl1"
        }
      }
    },
    "loadcollection2": {
      "process_id": "load_collection",
      "arguments": {
        "bands": [
          "SCL"
        ],
        "id": "SENTINEL2_L2A",
        "properties": {
          "eo:cloud_cover": {
            "process_graph": {
              "lte2": {
                "process_id": "lte",
                "arguments": {
                  "x": {
                    "from_parameter": "value"
                  },
                  "y": 70
                },
                "result": true
              }
            }
          }
        },
        "spatial_extent": null,
        "temporal_extent": {
          "from_parameter": "temporal_extent"
        }
      }
    },
    "loadurl2": {
      "process_id": "load_url",
      "arguments": {
        "format": "Parquet",
        "url": "https://s3.prod.warsaw.openeo.dataspace.copernicus.eu/OpenEO-artifacts/7b9a7a133160c440a4fa6586e3a3de183e1df18e/2024/11/18/bounding_box_geometry.parquet?AWSAccessKeyId=93bf46120a0b46e18320c7a794f7c5d0&Signature=RtwpmS%2B%2B3gA9t01PTyDQ5dHGw%2BM%3D&x-amz-security-token=eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2xlX2FybiI6ImFybjphd3M6aWFtOjowMDAwMDAwMDAwMDA6cm9sZS9TM0FjY2VzcyIsImluaXRpYWxfaXNzdWVyIjoiaHR0cHM6Ly9pZGVudGl0eS5kYXRhc3BhY2UuY29wZXJuaWN1cy5ldS9hdXRoL3JlYWxtcy9DRFNFIiwiaXNzIjoic3RzLnByb2Qud2Fyc2F3Lm9wZW5lby5kYXRhc3BhY2UuY29wZXJuaWN1cy5ldSIsInN1YiI6ImE0MjFmODQ5LTJhZTYtNDJkMy05M2YwLWI0M2FhMjU2N2YxZSIsImV4cCI6MTczMTk2OTQ4OCwibmJmIjoxNzMxOTI2Mjg4LCJpYXQiOjE3MzE5MjYyODgsImp0aSI6ImI0MTAzNzZhLWIyNzItNDAxNC1hMzUyLTgzOTZhMWM2NjczMSJ9.nETcVLb8OHY6AiODQT6wxKWLMlgsP7CMnhyYfFWy9Z8SAs3hQiCunEXwogX8etLa6SMUIDKY5dsit6f8R2sNS-BInrz2H8phqc7gYC6MXAhsxis8QPDS9I5mvuD4m0DOnUZJ2Sd36TmQ7gNbdF2aLRZeH-ikCgNaE990JHmywhkR1z5r1nR5HCRKS2V8evy6n9jj9_5bmt-qrjx27I2o0xhGAY0E9tg49UEA7Cerjh5zdJ-SLtudPUPp8_gGPSC5CfVlLfBdBJWBQiDwq6qaf884yhdJ-ObnNHS73japZEPmd7rjOfOsBlkA6Jk8OqlesjKzpCD-Bm454IdkGf4p_w&Expires=1732444689"
      }
    },
    "filterspatial2": {
      "process_id": "filter_spatial",
      "arguments": {
        "data": {
          "from_node": "loadcollection2"
        },
        "geometries": {
          "from_node": "loadurl2"
        }
      }
    },
    "toscldilationmask1": {
      "process_id": "to_scl_dilation_mask",
      "arguments": {
        "data": {
          "from_node": "filterspatial2"
        }
      }
    },
    "mask1": {
      "process_id": "mask",
      "arguments": {
        "data": {
          "from_node": "filterspatial1"
        },
        "mask": {
          "from_node": "toscldilationmask1"
        }
      }
    },
    "aggregatetemporalperiod1": {
      "process_id": "aggregate_temporal_period",
      "arguments": {
        "data": {
          "from_node": "mask1"
        },
        "period": "week",
        "reducer": {
          "process_graph": {
            "mean1": {
              "process_id": "mean",
              "arguments": {
                "data": {
                  "from_parameter": "data"
                }
              },
              "result": true
            }
          }
        }
      }
    },
    "applydimension1": {
      "process_id": "apply_dimension",
      "arguments": {
        "data": {
          "from_node": "aggregatetemporalperiod1"
        },
        "dimension": "t",
        "process": {
          "process_graph": {
            "quantiles1": {
              "process_id": "quantiles",
              "arguments": {
                "data": {
                  "from_parameter": "data"
                },
                "probabilities": [
                  0.1,
                  0.25,
                  0.5,
                  0.75,
                  0.9
                ]
              },
              "result": true
            }
          }
        },
        "target_dimension": "bands"
      }
    },
    "renamelabels1": {
      "process_id": "rename_labels",
      "arguments": {
        "data": {
          "from_node": "applydimension1"
        },
        "dimension": "bands",
        "target": [
          "B04_P10",
          "B04_P25",
          "B04_P50",
          "B04_P75",
          "B04_P90",
          "B03_P10",
          "B03_P25",
          "B03_P50",
          "B03_P75",
          "B03_P90",
          "B02_P10",
          "B02_P25",
          "B02_P50",
          "B02_P75",
          "B02_P90"
        ]
      }
    },
    "saveresult1": {
      "process_id": "save_result",
      "arguments": {
        "data": {
          "from_node": "renamelabels1"
        },
        "format": "NetCDF",
        "options": {}
      },
      "result": true
    }
  },
  "id": "s2_weekly_statistics",
  "parameters": [
    {
      "name": "temporal_extent",
      "description": "Temporal extent specified as two-element array with start and end date/date-time.",
      "schema": {
        "type": "array",
        "subtype": "temporal-interval",
        "uniqueItems": true,
        "minItems": 2,
        "maxItems": 2,
        "items": {
          "anyOf": [
            {
              "type": "string",
              "subtype": "date-time",
              "format": "date-time"
            },
            {
              "type": "string",
              "subtype": "date",
              "format": "date"
            },
            {
              "type": "null"
            }
          ]
        }
      }
    },
    {
      "name": "geometry",
      "description": "Geometries specified as GeoJSON object.",
      "schema": {
        "type": "object",
        "subtype": "geojson"
      }
    },
    {
      "name": "bands",
      "description": "Sentinel-2 L2A bands to include in the composite.",
      "schema": {
        "type": "array",
        "items": {
          "type": "string",
          "enum": [
            "B02",
            "B03",
            "B04",
            "B05",
            "B06",
            "B07",
            "B08",
            "B8A",
            "B11",
            "B12"
          ]
        }
      },
      "optional": true,
      "default": [
        "B04",
        "B03",
        "B02"
      ]
    },
    {
      "name": "percentiles",
      "description": "percentiles calculated across the BAP composite.",
      "schema": {
        "type": "array"
      },
      "optional": true,
      "default": [
        0.1,
        0.25,
        0.5,
        0.75,
        0.9
      ]
    }
  ]
}